(function(root,mod){if(typeof exports=="object"&&typeof module=="object")return mod(exports);if(typeof define=="function"&&define.amd)return define(["exports"],mod);mod(root.acorn||(root.acorn={}))})(this,function(exports){"use strict";exports.version="0.4.1";var options,input,inputLen,sourceFile;exports.parse=function(inpt,opts){input=String(inpt);inputLen=input.length;setOptions(opts);initTokenState();return parseTopLevel(options.program)};var defaultOptions=exports.defaultOptions={ecmaVersion:5,strictSemicolons:false,allowTrailingCommas:true,forbidReserved:false,locations:false,onComment:null,ranges:false,program:null,sourceFile:null,directSourceFile:null};function setOptions(opts){options=opts||{};for(var opt in defaultOptions)if(!Object.prototype.hasOwnProperty.call(options,opt))options[opt]=defaultOptions[opt];sourceFile=options.sourceFile||null}var getLineInfo=exports.getLineInfo=function(input,offset){for(var line=1,cur=0;;){lineBreak.lastIndex=cur;var match=lineBreak.exec(input);if(match&&match.index<offset){++line;cur=match.index+match[0].length}else break}return{line:line,column:offset-cur}};exports.tokenize=function(inpt,opts){input=String(inpt);inputLen=input.length;setOptions(opts);initTokenState();var t={};function getToken(forceRegexp){readToken(forceRegexp);t.start=tokStart;t.end=tokEnd;t.startLoc=tokStartLoc;t.endLoc=tokEndLoc;t.type=tokType;t.value=tokVal;return t}getToken.jumpTo=function(pos,reAllowed){tokPos=pos;if(options.locations){tokCurLine=1;tokLineStart=lineBreak.lastIndex=0;var match;while((match=lineBreak.exec(input))&&match.index<pos){++tokCurLine;tokLineStart=match.index+match[0].length}}tokRegexpAllowed=reAllowed;skipSpace()};return getToken};var tokPos;var tokStart,tokEnd;var tokStartLoc,tokEndLoc;var tokType,tokVal;var tokRegexpAllowed;var tokCurLine,tokLineStart;var lastStart,lastEnd,lastEndLoc;var inFunction,labels,strict;function raise(pos,message){var loc=getLineInfo(input,pos);message+=" ("+loc.line+":"+loc.column+")";var err=new SyntaxError(message);err.pos=pos;err.loc=loc;err.raisedAt=tokPos;throw err}var empty=[];var _num={type:"num"},_regexp={type:"regexp"},_string={type:"string"};var _name={type:"name"},_eof={type:"eof"};var _break={keyword:"break"},_case={keyword:"case",beforeExpr:true},_catch={keyword:"catch"};var _continue={keyword:"continue"},_debugger={keyword:"debugger"},_default={keyword:"default"};var _do={keyword:"do",isLoop:true},_else={keyword:"else",beforeExpr:true};var _finally={keyword:"finally"},_for={keyword:"for",isLoop:true},_function={keyword:"function"};var _if={keyword:"if"},_return={keyword:"return",beforeExpr:true},_switch={keyword:"switch"};var _throw={keyword:"throw",beforeExpr:true},_try={keyword:"try"},_var={keyword:"var"};var _while={keyword:"while",isLoop:true},_with={keyword:"with"},_new={keyword:"new",beforeExpr:true};var _this={keyword:"this"};var _null={keyword:"null",atomValue:null},_true={keyword:"true",atomValue:true};var _false={keyword:"false",atomValue:false};var _in={keyword:"in",binop:7,beforeExpr:true};var keywordTypes={"break":_break,"case":_case,"catch":_catch,"continue":_continue,"debugger":_debugger,"default":_default,"do":_do,"else":_else,"finally":_finally,"for":_for,"function":_function,"if":_if,"return":_return,"switch":_switch,"throw":_throw,"try":_try,"var":_var,"while":_while,"with":_with,"null":_null,"true":_true,"false":_false,"new":_new,"in":_in,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:true},"this":_this,"typeof":{keyword:"typeof",prefix:true,beforeExpr:true},"void":{keyword:"void",prefix:true,beforeExpr:true},"delete":{keyword:"delete",prefix:true,beforeExpr:true}};var _bracketL={type:"[",beforeExpr:true},_bracketR={type:"]"},_braceL={type:"{",beforeExpr:true};var _braceR={type:"}"},_parenL={type:"(",beforeExpr:true},_parenR={type:")"};var _comma={type:",",beforeExpr:true},_semi={type:";",beforeExpr:true};var _colon={type:":",beforeExpr:true},_dot={type:"."},_question={type:"?",beforeExpr:true};var _slash={binop:10,beforeExpr:true},_eq={isAssign:true,beforeExpr:true};var _assign={isAssign:true,beforeExpr:true};var _incDec={postfix:true,prefix:true,isUpdate:true},_prefix={prefix:true,beforeExpr:true};var _logicalOR={binop:1,beforeExpr:true};var _logicalAND={binop:2,beforeExpr:true};var _bitwiseOR={binop:3,beforeExpr:true};var _bitwiseXOR={binop:4,beforeExpr:true};var _bitwiseAND={binop:5,beforeExpr:true};var _equality={binop:6,beforeExpr:true};var _relational={binop:7,beforeExpr:true};var _bitShift={binop:8,beforeExpr:true};var _plusMin={binop:9,prefix:true,beforeExpr:true};var _multiplyModulo={binop:10,beforeExpr:true};exports.tokTypes={bracketL:_bracketL,bracketR:_bracketR,braceL:_braceL,braceR:_braceR,parenL:_parenL,parenR:_parenR,comma:_comma,semi:_semi,colon:_colon,dot:_dot,question:_question,slash:_slash,eq:_eq,name:_name,eof:_eof,num:_num,regexp:_regexp,string:_string};for(var kw in keywordTypes)exports.tokTypes["_"+kw]=keywordTypes[kw];function makePredicate(words){words=words.split(" ");var f="",cats=[];out:for(var i=0;i<words.length;++i){for(var j=0;j<cats.length;++j)if(cats[j][0].length==words[i].length){cats[j].push(words[i]);continue out}cats.push([words[i]])}function compareTo(arr){if(arr.length==1)return f+="return str === "+JSON.stringify(arr[0])+";";f+="switch(str){";for(var i=0;i<arr.length;++i)f+="case "+JSON.stringify(arr[i])+":";f+="return true}return false;"}if(cats.length>3){cats.sort(function(a,b){return b.length-a.length});f+="switch(str.length){";for(var i=0;i<cats.length;++i){var cat=cats[i];f+="case "+cat[0].length+":";compareTo(cat)}f+="}"}else{compareTo(words)}return new Function("str",f)}var isReservedWord3=makePredicate("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile");var isReservedWord5=makePredicate("class enum extends super const export import");var isStrictReservedWord=makePredicate("implements interface let package private protected public static yield");var isStrictBadIdWord=makePredicate("eval arguments");var isKeyword=makePredicate("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this");var nonASCIIwhitespace=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;var nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ";var nonASCIIidentifierChars="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿";var nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]");var nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");var newline=/[\n\r\u2028\u2029]/;var lineBreak=/\r\n|[\n\r\u2028\u2029]/g;var isIdentifierStart=exports.isIdentifierStart=function(code){if(code<65)return code===36;if(code<91)return true;if(code<97)return code===95;if(code<123)return true;return code>=170&&nonASCIIidentifierStart.test(String.fromCharCode(code))};var isIdentifierChar=exports.isIdentifierChar=function(code){if(code<48)return code===36;if(code<58)return true;if(code<65)return false;if(code<91)return true;if(code<97)return code===95;if(code<123)return true;return code>=170&&nonASCIIidentifier.test(String.fromCharCode(code))};function line_loc_t(){this.line=tokCurLine;this.column=tokPos-tokLineStart}function initTokenState(){tokCurLine=1;tokPos=tokLineStart=0;tokRegexpAllowed=true;skipSpace()}function finishToken(type,val){tokEnd=tokPos;if(options.locations)tokEndLoc=new line_loc_t;tokType=type;skipSpace();tokVal=val;tokRegexpAllowed=type.beforeExpr}function skipBlockComment(){var startLoc=options.onComment&&options.locations&&new line_loc_t;var start=tokPos,end=input.indexOf("*/",tokPos+=2);if(end===-1)raise(tokPos-2,"Unterminated comment");tokPos=end+2;if(options.locations){lineBreak.lastIndex=start;var match;while((match=lineBreak.exec(input))&&match.index<tokPos){++tokCurLine;tokLineStart=match.index+match[0].length}}if(options.onComment)options.onComment(true,input.slice(start+2,end),start,tokPos,startLoc,options.locations&&new line_loc_t)}function skipLineComment(){var start=tokPos;var startLoc=options.onComment&&options.locations&&new line_loc_t;var ch=input.charCodeAt(tokPos+=2);while(tokPos<inputLen&&ch!==10&&ch!==13&&ch!==8232&&ch!==8233){++tokPos;ch=input.charCodeAt(tokPos)}if(options.onComment)options.onComment(false,input.slice(start+2,tokPos),start,tokPos,startLoc,options.locations&&new line_loc_t)}function skipSpace(){while(tokPos<inputLen){var ch=input.charCodeAt(tokPos);if(ch===32){++tokPos}else if(ch===13){++tokPos;var next=input.charCodeAt(tokPos);if(next===10){++tokPos}if(options.locations){++tokCurLine;tokLineStart=tokPos}}else if(ch===10||ch===8232||ch===8233){++tokPos;if(options.locations){++tokCurLine;tokLineStart=tokPos}}else if(ch>8&&ch<14){++tokPos}else if(ch===47){var next=input.charCodeAt(tokPos+1);if(next===42){skipBlockComment()}else if(next===47){skipLineComment()}else break}else if(ch===160){++tokPos}else if(ch>=5760&&nonASCIIwhitespace.test(String.fromCharCode(ch))){++tokPos}else{break}}}function readToken_dot(){var next=input.charCodeAt(tokPos+1);if(next>=48&&next<=57)return readNumber(true);++tokPos;return finishToken(_dot)}function readToken_slash(){var next=input.charCodeAt(tokPos+1);if(tokRegexpAllowed){++tokPos;return readRegexp()}if(next===61)return finishOp(_assign,2);return finishOp(_slash,1)}function readToken_mult_modulo(){var next=input.charCodeAt(tokPos+1);if(next===61)return finishOp(_assign,2);return finishOp(_multiplyModulo,1)}function readToken_pipe_amp(code){var next=input.charCodeAt(tokPos+1);if(next===code)return finishOp(code===124?_logicalOR:_logicalAND,2);if(next===61)return finishOp(_assign,2);return finishOp(code===124?_bitwiseOR:_bitwiseAND,1)}function readToken_caret(){var next=input.charCodeAt(tokPos+1);if(next===61)return finishOp(_assign,2);return finishOp(_bitwiseXOR,1)}function readToken_plus_min(code){var next=input.charCodeAt(tokPos+1);if(next===code){if(next==45&&input.charCodeAt(tokPos+2)==62&&newline.test(input.slice(lastEnd,tokPos))){tokPos+=3;skipLineComment();skipSpace();return readToken()}return finishOp(_incDec,2)}if(next===61)return finishOp(_assign,2);return finishOp(_plusMin,1)}function readToken_lt_gt(code){var next=input.charCodeAt(tokPos+1);var size=1;if(next===code){size=code===62&&input.charCodeAt(tokPos+2)===62?3:2;if(input.charCodeAt(tokPos+size)===61)return finishOp(_assign,size+1);return finishOp(_bitShift,size)}if(next==33&&code==60&&input.charCodeAt(tokPos+2)==45&&input.charCodeAt(tokPos+3)==45){tokPos+=4;skipLineComment();skipSpace();return readToken()}if(next===61)size=input.charCodeAt(tokPos+2)===61?3:2;return finishOp(_relational,size)}function readToken_eq_excl(code){var next=input.charCodeAt(tokPos+1);if(next===61)return finishOp(_equality,input.charCodeAt(tokPos+2)===61?3:2);return finishOp(code===61?_eq:_prefix,1)}function getTokenFromCode(code){switch(code){case 46:return readToken_dot();case 40:++tokPos;return finishToken(_parenL);case 41:++tokPos;return finishToken(_parenR);case 59:++tokPos;return finishToken(_semi);case 44:++tokPos;return finishToken(_comma);case 91:++tokPos;return finishToken(_bracketL);case 93:++tokPos;return finishToken(_bracketR);case 123:++tokPos;return finishToken(_braceL);case 125:++tokPos;return finishToken(_braceR);case 58:++tokPos;return finishToken(_colon);case 63:++tokPos;return finishToken(_question);case 48:var next=input.charCodeAt(tokPos+1);if(next===120||next===88)return readHexNumber();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return readNumber(false);case 34:case 39:return readString(code);case 47:return readToken_slash(code);case 37:case 42:return readToken_mult_modulo();case 124:case 38:return readToken_pipe_amp(code);case 94:return readToken_caret();case 43:case 45:return readToken_plus_min(code);case 60:case 62:return readToken_lt_gt(code);case 61:case 33:return readToken_eq_excl(code);case 126:return finishOp(_prefix,1)}return false}function readToken(forceRegexp){if(!forceRegexp)tokStart=tokPos;else tokPos=tokStart+1;if(options.locations)tokStartLoc=new line_loc_t;if(forceRegexp)return readRegexp();if(tokPos>=inputLen)return finishToken(_eof);var code=input.charCodeAt(tokPos);if(isIdentifierStart(code)||code===92)return readWord();var tok=getTokenFromCode(code);if(tok===false){var ch=String.fromCharCode(code);if(ch==="\\"||nonASCIIidentifierStart.test(ch))return readWord();raise(tokPos,"Unexpected character '"+ch+"'")}return tok}function finishOp(type,size){var str=input.slice(tokPos,tokPos+size);tokPos+=size;finishToken(type,str)}function readRegexp(){var content="",escaped,inClass,start=tokPos;for(;;){if(tokPos>=inputLen)raise(start,"Unterminated regular expression");var ch=input.charAt(tokPos);if(newline.test(ch))raise(start,"Unterminated regular expression");if(!escaped){if(ch==="[")inClass=true;else if(ch==="]"&&inClass)inClass=false;else if(ch==="/"&&!inClass)break;escaped=ch==="\\"}else escaped=false;++tokPos}var content=input.slice(start,tokPos);++tokPos;var mods=readWord1();if(mods&&!/^[gmsiy]*$/.test(mods))raise(start,"Invalid regexp flag");return finishToken(_regexp,new RegExp(content,mods))}function readInt(radix,len){var start=tokPos,total=0;for(var i=0,e=len==null?Infinity:len;i<e;++i){var code=input.charCodeAt(tokPos),val;if(code>=97)val=code-97+10;else if(code>=65)val=code-65+10;else if(code>=48&&code<=57)val=code-48;else val=Infinity;if(val>=radix)break;++tokPos;total=total*radix+val}if(tokPos===start||len!=null&&tokPos-start!==len)return null;return total}function readHexNumber(){tokPos+=2;var val=readInt(16);if(val==null)raise(tokStart+2,"Expected hexadecimal number");if(isIdentifierStart(input.charCodeAt(tokPos)))raise(tokPos,"Identifier directly after number");return finishToken(_num,val)}function readNumber(startsWithDot){var start=tokPos,isFloat=false,octal=input.charCodeAt(tokPos)===48;if(!startsWithDot&&readInt(10)===null)raise(start,"Invalid number");if(input.charCodeAt(tokPos)===46){++tokPos;readInt(10);isFloat=true}var next=input.charCodeAt(tokPos);if(next===69||next===101){next=input.charCodeAt(++tokPos);if(next===43||next===45)++tokPos;if(readInt(10)===null)raise(start,"Invalid number");isFloat=true}if(isIdentifierStart(input.charCodeAt(tokPos)))raise(tokPos,"Identifier directly after number");var str=input.slice(start,tokPos),val;if(isFloat)val=parseFloat(str);else if(!octal||str.length===1)val=parseInt(str,10);else if(/[89]/.test(str)||strict)raise(start,"Invalid number");else val=parseInt(str,8);return finishToken(_num,val)}function readString(quote){tokPos++;var out="";for(;;){if(tokPos>=inputLen)raise(tokStart,"Unterminated string constant");var ch=input.charCodeAt(tokPos);if(ch===quote){++tokPos;return finishToken(_string,out)}if(ch===92){ch=input.charCodeAt(++tokPos);var octal=/^[0-7]+/.exec(input.slice(tokPos,tokPos+3));if(octal)octal=octal[0];while(octal&&parseInt(octal,8)>255)octal=octal.slice(0,-1);if(octal==="0")octal=null;++tokPos;if(octal){if(strict)raise(tokPos-2,"Octal literal in strict mode");out+=String.fromCharCode(parseInt(octal,8));tokPos+=octal.length-1}else{switch(ch){case 110:out+="\n";break;case 114:out+="\r";break;case 120:out+=String.fromCharCode(readHexChar(2));break;case 117:out+=String.fromCharCode(readHexChar(4));break;case 85:out+=String.fromCharCode(readHexChar(8));break;case 116:out+="	";break;case 98:out+="\b";break;case 118:out+="";break;case 102:out+="\f";break;case 48:out+="\x00";break;case 13:if(input.charCodeAt(tokPos)===10)++tokPos;case 10:if(options.locations){tokLineStart=tokPos;++tokCurLine}break;default:out+=String.fromCharCode(ch);break}}}else{if(ch===13||ch===10||ch===8232||ch===8233)raise(tokStart,"Unterminated string constant");out+=String.fromCharCode(ch);++tokPos}}}function readHexChar(len){var n=readInt(16,len);if(n===null)raise(tokStart,"Bad character escape sequence");return n}var containsEsc;function readWord1(){containsEsc=false;var word,first=true,start=tokPos;for(;;){var ch=input.charCodeAt(tokPos);if(isIdentifierChar(ch)){if(containsEsc)word+=input.charAt(tokPos);++tokPos}else if(ch===92){if(!containsEsc)word=input.slice(start,tokPos);containsEsc=true;if(input.charCodeAt(++tokPos)!=117)raise(tokPos,"Expecting Unicode escape sequence \\uXXXX");++tokPos;var esc=readHexChar(4);var escStr=String.fromCharCode(esc);if(!escStr)raise(tokPos-1,"Invalid Unicode escape");if(!(first?isIdentifierStart(esc):isIdentifierChar(esc)))raise(tokPos-4,"Invalid Unicode escape");word+=escStr}else{break}first=false}return containsEsc?word:input.slice(start,tokPos)}function readWord(){var word=readWord1();var type=_name;if(!containsEsc){if(isKeyword(word))type=keywordTypes[word];else if(options.forbidReserved&&(options.ecmaVersion===3?isReservedWord3:isReservedWord5)(word)||strict&&isStrictReservedWord(word))raise(tokStart,"The keyword '"+word+"' is reserved")}return finishToken(type,word)}function next(){lastStart=tokStart;lastEnd=tokEnd;lastEndLoc=tokEndLoc;readToken()}function setStrict(strct){strict=strct;tokPos=lastEnd;if(options.locations){while(tokPos<tokLineStart){tokLineStart=input.lastIndexOf("\n",tokLineStart-2)+1;--tokCurLine}}skipSpace();readToken()}function node_t(){this.type=null;this.start=tokStart;this.end=null}function node_loc_t(){this.start=tokStartLoc;this.end=null;if(sourceFile!==null)this.source=sourceFile}function startNode(){var node=new node_t;if(options.locations)node.loc=new node_loc_t;if(options.directSourceFile)node.sourceFile=options.directSourceFile;if(options.ranges)node.range=[tokStart,0];return node}function startNodeFrom(other){var node=new node_t;node.start=other.start;if(options.locations){node.loc=new node_loc_t;node.loc.start=other.loc.start}if(options.ranges)node.range=[other.range[0],0];return node}function finishNode(node,type){node.type=type;node.end=lastEnd;if(options.locations)node.loc.end=lastEndLoc;if(options.ranges)node.range[1]=lastEnd;return node}function isUseStrict(stmt){return options.ecmaVersion>=5&&stmt.type==="ExpressionStatement"&&stmt.expression.type==="Literal"&&stmt.expression.value==="use strict"}function eat(type){if(tokType===type){next();return true}}function canInsertSemicolon(){return!options.strictSemicolons&&(tokType===_eof||tokType===_braceR||newline.test(input.slice(lastEnd,tokStart)))}function semicolon(){if(!eat(_semi)&&!canInsertSemicolon())unexpected()}function expect(type){if(tokType===type)next();else unexpected()}function unexpected(){raise(tokStart,"Unexpected token")}function checkLVal(expr){if(expr.type!=="Identifier"&&expr.type!=="MemberExpression")raise(expr.start,"Assigning to rvalue");if(strict&&expr.type==="Identifier"&&isStrictBadIdWord(expr.name))raise(expr.start,"Assigning to "+expr.name+" in strict mode")}function parseTopLevel(program){lastStart=lastEnd=tokPos;if(options.locations)lastEndLoc=new line_loc_t;inFunction=strict=null;labels=[];readToken();var node=program||startNode(),first=true;if(!program)node.body=[];while(tokType!==_eof){var stmt=parseStatement();node.body.push(stmt);if(first&&isUseStrict(stmt))setStrict(true);first=false}return finishNode(node,"Program")}var loopLabel={kind:"loop"},switchLabel={kind:"switch"};function parseStatement(){if(tokType===_slash||tokType===_assign&&tokVal=="/=")readToken(true);var starttype=tokType,node=startNode();switch(starttype){case _break:case _continue:next();var isBreak=starttype===_break;if(eat(_semi)||canInsertSemicolon())node.label=null;else if(tokType!==_name)unexpected();else{node.label=parseIdent();semicolon()}for(var i=0;i<labels.length;++i){var lab=labels[i];if(node.label==null||lab.name===node.label.name){if(lab.kind!=null&&(isBreak||lab.kind==="loop"))break;if(node.label&&isBreak)break}}if(i===labels.length)raise(node.start,"Unsyntactic "+starttype.keyword);return finishNode(node,isBreak?"BreakStatement":"ContinueStatement");case _debugger:next();semicolon();return finishNode(node,"DebuggerStatement");case _do:next();labels.push(loopLabel);node.body=parseStatement();labels.pop();expect(_while);node.test=parseParenExpression();semicolon();return finishNode(node,"DoWhileStatement");case _for:next();labels.push(loopLabel);expect(_parenL);if(tokType===_semi)return parseFor(node,null);if(tokType===_var){var init=startNode();next();parseVar(init,true);finishNode(init,"VariableDeclaration");if(init.declarations.length===1&&eat(_in))return parseForIn(node,init);return parseFor(node,init)}var init=parseExpression(false,true);if(eat(_in)){checkLVal(init);return parseForIn(node,init)}return parseFor(node,init);case _function:next();return parseFunction(node,true);case _if:next();node.test=parseParenExpression();node.consequent=parseStatement();node.alternate=eat(_else)?parseStatement():null;return finishNode(node,"IfStatement");case _return:if(!inFunction)raise(tokStart,"'return' outside of function");next();if(eat(_semi)||canInsertSemicolon())node.argument=null;else{node.argument=parseExpression();semicolon()}return finishNode(node,"ReturnStatement");case _switch:next();node.discriminant=parseParenExpression();node.cases=[];expect(_braceL);labels.push(switchLabel);for(var cur,sawDefault;tokType!=_braceR;){if(tokType===_case||tokType===_default){var isCase=tokType===_case;if(cur)finishNode(cur,"SwitchCase");node.cases.push(cur=startNode());cur.consequent=[];next();if(isCase)cur.test=parseExpression();else{if(sawDefault)raise(lastStart,"Multiple default clauses");sawDefault=true;cur.test=null}expect(_colon)}else{if(!cur)unexpected();cur.consequent.push(parseStatement())}}if(cur)finishNode(cur,"SwitchCase");next();labels.pop();return finishNode(node,"SwitchStatement");case _throw:next();if(newline.test(input.slice(lastEnd,tokStart)))raise(lastEnd,"Illegal newline after throw");node.argument=parseExpression();semicolon();return finishNode(node,"ThrowStatement");case _try:next();node.block=parseBlock();node.handler=null;if(tokType===_catch){var clause=startNode();next();expect(_parenL);clause.param=parseIdent();if(strict&&isStrictBadIdWord(clause.param.name))raise(clause.param.start,"Binding "+clause.param.name+" in strict mode");expect(_parenR);clause.guard=null;clause.body=parseBlock();node.handler=finishNode(clause,"CatchClause")}node.guardedHandlers=empty;node.finalizer=eat(_finally)?parseBlock():null;if(!node.handler&&!node.finalizer)raise(node.start,"Missing catch or finally clause");return finishNode(node,"TryStatement");case _var:next();parseVar(node);semicolon();return finishNode(node,"VariableDeclaration");case _while:next();node.test=parseParenExpression();labels.push(loopLabel);node.body=parseStatement();labels.pop();return finishNode(node,"WhileStatement");case _with:if(strict)raise(tokStart,"'with' in strict mode");next();node.object=parseParenExpression();node.body=parseStatement();return finishNode(node,"WithStatement");case _braceL:return parseBlock();case _semi:next();return finishNode(node,"EmptyStatement");default:var maybeName=tokVal,expr=parseExpression();if(starttype===_name&&expr.type==="Identifier"&&eat(_colon)){for(var i=0;i<labels.length;++i)if(labels[i].name===maybeName)raise(expr.start,"Label '"+maybeName+"' is already declared");var kind=tokType.isLoop?"loop":tokType===_switch?"switch":null;labels.push({name:maybeName,kind:kind});node.body=parseStatement();labels.pop();node.label=expr;return finishNode(node,"LabeledStatement")}else{node.expression=expr;semicolon();return finishNode(node,"ExpressionStatement")}}}function parseParenExpression(){expect(_parenL);var val=parseExpression();expect(_parenR);return val}function parseBlock(allowStrict){var node=startNode(),first=true,strict=false,oldStrict;node.body=[];expect(_braceL);while(!eat(_braceR)){var stmt=parseStatement();node.body.push(stmt);if(first&&allowStrict&&isUseStrict(stmt)){oldStrict=strict;setStrict(strict=true)}first=false}if(strict&&!oldStrict)setStrict(false);return finishNode(node,"BlockStatement")}function parseFor(node,init){node.init=init;expect(_semi);node.test=tokType===_semi?null:parseExpression();expect(_semi);node.update=tokType===_parenR?null:parseExpression();expect(_parenR);node.body=parseStatement();labels.pop();return finishNode(node,"ForStatement")}function parseForIn(node,init){node.left=init;node.right=parseExpression();expect(_parenR);node.body=parseStatement();labels.pop();return finishNode(node,"ForInStatement")}function parseVar(node,noIn){node.declarations=[];node.kind="var";for(;;){var decl=startNode();decl.id=parseIdent();if(strict&&isStrictBadIdWord(decl.id.name))raise(decl.id.start,"Binding "+decl.id.name+" in strict mode");decl.init=eat(_eq)?parseExpression(true,noIn):null;node.declarations.push(finishNode(decl,"VariableDeclarator"));if(!eat(_comma))break}return node}function parseExpression(noComma,noIn){var expr=parseMaybeAssign(noIn);if(!noComma&&tokType===_comma){var node=startNodeFrom(expr);node.expressions=[expr];while(eat(_comma))node.expressions.push(parseMaybeAssign(noIn));return finishNode(node,"SequenceExpression")}return expr}function parseMaybeAssign(noIn){var left=parseMaybeConditional(noIn);if(tokType.isAssign){var node=startNodeFrom(left);node.operator=tokVal;node.left=left;next();node.right=parseMaybeAssign(noIn);checkLVal(left);return finishNode(node,"AssignmentExpression")}return left}function parseMaybeConditional(noIn){var expr=parseExprOps(noIn);if(eat(_question)){var node=startNodeFrom(expr);node.test=expr;node.consequent=parseExpression(true);expect(_colon);node.alternate=parseExpression(true,noIn);return finishNode(node,"ConditionalExpression")}return expr}function parseExprOps(noIn){return parseExprOp(parseMaybeUnary(),-1,noIn)}function parseExprOp(left,minPrec,noIn){var prec=tokType.binop;if(prec!=null&&(!noIn||tokType!==_in)){if(prec>minPrec){var node=startNodeFrom(left);node.left=left;node.operator=tokVal;var op=tokType;next();node.right=parseExprOp(parseMaybeUnary(),prec,noIn);var exprNode=finishNode(node,op===_logicalOR||op===_logicalAND?"LogicalExpression":"BinaryExpression");return parseExprOp(exprNode,minPrec,noIn)}}return left}function parseMaybeUnary(){if(tokType.prefix){var node=startNode(),update=tokType.isUpdate;node.operator=tokVal;node.prefix=true;tokRegexpAllowed=true;next();node.argument=parseMaybeUnary();if(update)checkLVal(node.argument);else if(strict&&node.operator==="delete"&&node.argument.type==="Identifier")raise(node.start,"Deleting local variable in strict mode");return finishNode(node,update?"UpdateExpression":"UnaryExpression")}var expr=parseExprSubscripts();while(tokType.postfix&&!canInsertSemicolon()){var node=startNodeFrom(expr);node.operator=tokVal;node.prefix=false;node.argument=expr;checkLVal(expr);next();expr=finishNode(node,"UpdateExpression")}return expr}function parseExprSubscripts(){return parseSubscripts(parseExprAtom())}function parseSubscripts(base,noCalls){if(eat(_dot)){var node=startNodeFrom(base);node.object=base;node.property=parseIdent(true);node.computed=false;return parseSubscripts(finishNode(node,"MemberExpression"),noCalls)}else if(eat(_bracketL)){var node=startNodeFrom(base);node.object=base;node.property=parseExpression();node.computed=true;expect(_bracketR);return parseSubscripts(finishNode(node,"MemberExpression"),noCalls)}else if(!noCalls&&eat(_parenL)){var node=startNodeFrom(base);node.callee=base;node.arguments=parseExprList(_parenR,false);return parseSubscripts(finishNode(node,"CallExpression"),noCalls)}else return base}function parseExprAtom(){switch(tokType){case _this:var node=startNode();next();return finishNode(node,"ThisExpression");case _name:return parseIdent();case _num:case _string:case _regexp:var node=startNode();node.value=tokVal;node.raw=input.slice(tokStart,tokEnd);next();return finishNode(node,"Literal");case _null:case _true:case _false:var node=startNode();node.value=tokType.atomValue;node.raw=tokType.keyword;next();return finishNode(node,"Literal");case _parenL:var tokStartLoc1=tokStartLoc,tokStart1=tokStart;next();var val=parseExpression();val.start=tokStart1;val.end=tokEnd;if(options.locations){val.loc.start=tokStartLoc1;val.loc.end=tokEndLoc}if(options.ranges)val.range=[tokStart1,tokEnd];expect(_parenR);return val;case _bracketL:var node=startNode();next();node.elements=parseExprList(_bracketR,true,true);return finishNode(node,"ArrayExpression");case _braceL:return parseObj();case _function:var node=startNode();next();return parseFunction(node,false);case _new:return parseNew();default:unexpected()}}function parseNew(){var node=startNode();next();node.callee=parseSubscripts(parseExprAtom(),true);if(eat(_parenL))node.arguments=parseExprList(_parenR,false);else node.arguments=empty;return finishNode(node,"NewExpression")}function parseObj(){var node=startNode(),first=true,sawGetSet=false;node.properties=[];next();while(!eat(_braceR)){if(!first){expect(_comma);if(options.allowTrailingCommas&&eat(_braceR))break}else first=false;var prop={key:parsePropertyName()},isGetSet=false,kind;if(eat(_colon)){prop.value=parseExpression(true);kind=prop.kind="init"}else if(options.ecmaVersion>=5&&prop.key.type==="Identifier"&&(prop.key.name==="get"||prop.key.name==="set")){isGetSet=sawGetSet=true;kind=prop.kind=prop.key.name;prop.key=parsePropertyName();if(tokType!==_parenL)unexpected();prop.value=parseFunction(startNode(),false)}else unexpected();if(prop.key.type==="Identifier"&&(strict||sawGetSet)){for(var i=0;i<node.properties.length;++i){var other=node.properties[i];if(other.key.name===prop.key.name){var conflict=kind==other.kind||isGetSet&&other.kind==="init"||kind==="init"&&(other.kind==="get"||other.kind==="set");if(conflict&&!strict&&kind==="init"&&other.kind==="init")conflict=false;if(conflict)raise(prop.key.start,"Redefinition of property")}}}node.properties.push(prop)}return finishNode(node,"ObjectExpression")}function parsePropertyName(){if(tokType===_num||tokType===_string)return parseExprAtom();return parseIdent(true)}function parseFunction(node,isStatement){if(tokType===_name)node.id=parseIdent();else if(isStatement)unexpected();else node.id=null;node.params=[];var first=true;expect(_parenL);while(!eat(_parenR)){if(!first)expect(_comma);else first=false;node.params.push(parseIdent())}var oldInFunc=inFunction,oldLabels=labels;inFunction=true;labels=[];node.body=parseBlock(true);inFunction=oldInFunc;labels=oldLabels;if(strict||node.body.body.length&&isUseStrict(node.body.body[0])){for(var i=node.id?-1:0;i<node.params.length;++i){var id=i<0?node.id:node.params[i];if(isStrictReservedWord(id.name)||isStrictBadIdWord(id.name))raise(id.start,"Defining '"+id.name+"' in strict mode");if(i>=0)for(var j=0;j<i;++j)if(id.name===node.params[j].name)raise(id.start,"Argument name clash in strict mode");
}}return finishNode(node,isStatement?"FunctionDeclaration":"FunctionExpression")}function parseExprList(close,allowTrailingComma,allowEmpty){var elts=[],first=true;while(!eat(close)){if(!first){expect(_comma);if(allowTrailingComma&&options.allowTrailingCommas&&eat(close))break}else first=false;if(allowEmpty&&tokType===_comma)elts.push(null);else elts.push(parseExpression(true))}return elts}function parseIdent(liberal){var node=startNode();node.name=tokType===_name?tokVal:liberal&&!options.forbidReserved&&tokType.keyword||unexpected();tokRegexpAllowed=false;next();return finishNode(node,"Identifier")}});"use strict";goog.provide("Blocklify");Blockly.COLLAPSE_CHARS=100;Blocklify.importer=function(name){this.name_=name};Blocklify.importer.prototype.codeToDom=function(code,level){var program=this.astParser.parse(code);return this.convert(program,null,level)};"use strict";goog.provide("Blocklify.JavaScript");Blocklify.JavaScript.astParser=acorn;Blocklify.JavaScript.toolbox='<xml id="javascript_toolbox" style="display: none">'+'<category name="Variables">'+'<block type="js_variable_declaration_unary">'+'<value name="VAR">'+'<block type="js_identifier">'+'<field name="NAME">i</field>'+"</block>"+"</value>"+'<value name="VALUE">'+'<block type="js_literal_number">'+'<field name="NUMBER">0</field>'+"</block>"+"</value>"+"</block>"+'<block type="js_variable_declaration">'+'<value name="DECLARATIONS">'+'<block type="js_variable_declarator">'+'<value name="VAR">'+'<block type="js_identifier">'+'<field name="NAME">i</field>'+"</block>"+"</value>"+'<value name="VALUE">'+'<block type="js_literal_number">'+'<field name="NUMBER">0</field>'+"</block>"+"</value>"+"</block>"+"</value>"+"</block>"+"</category>"+'<category name="Expressions">'+'<block type="js_assignment_expression">'+'<value name="VAR">'+'<block type="js_identifier">'+'<field name="NAME">i</field>'+"</block>"+"</value>"+'<value name="VALUE">'+'<block type="js_literal_number">'+'<field name="NUMBER">0</field>'+"</block>"+"</value>"+"</block>"+"</category>"+"<sep></sep>"+'<category name="Data">'+'<block type="js_identifier"></block>'+'<block type="js_literal_number"></block>'+'<block type="js_literal_string"></block>'+'<block type="js_literal_bool"></block>'+'<block type="js_null_value"></block>'+'<block type="js_json_object"></block>'+'<block type="js_json_element"></block>'+'<block type="js_computed_member_expression"></block>'+"</category>"+'<category name="Variables">'+'<block type="js_variable_declaration_unary"></block>'+'<block type="js_variable_declarator"></block>'+'<block type="js_variable_declaration"></block>'+"</category>"+'<category name="Expressions">'+'<block type="js_assignment_expression"></block>'+'<block type="js_binary_expression"></block>'+'<block type="js_array_expression"></block>'+'<block type="js_member_expression"></block>'+'<block type="js_update_expression_prefix"></block>'+'<block type="js_update_expression_noprefix"></block>'+"</category>"+'<category name="Statements">'+'<block type="js_if_statement"></block>'+'<block type="js_for_statement"></block>'+'<block type="js_return_statement"></block>'+"</category>"+'<category name="Functions">'+'<block type="js_function_expression"></block>'+'<block type="js_anonimous_function_expression"></block>'+'<block type="js_call_expression"></block>'+"</category>"+"</xml>";"use strict";goog.provide("Blocklify.JavaScript.Generator");Blocklify.JavaScript.Generator=new Blockly.Generator("JavaScript");Blocklify.JavaScript.Generator.ORDER_ATOMIC=0;Blocklify.JavaScript.Generator.ORDER_MEMBER=1;Blocklify.JavaScript.Generator.ORDER_NEW=1;Blocklify.JavaScript.Generator.ORDER_FUNCTION_CALL=2;Blocklify.JavaScript.Generator.ORDER_INCREMENT=3;Blocklify.JavaScript.Generator.ORDER_DECREMENT=3;Blocklify.JavaScript.Generator.ORDER_LOGICAL_NOT=4;Blocklify.JavaScript.Generator.ORDER_BITWISE_NOT=4;Blocklify.JavaScript.Generator.ORDER_UNARY_PLUS=4;Blocklify.JavaScript.Generator.ORDER_UNARY_NEGATION=4;Blocklify.JavaScript.Generator.ORDER_TYPEOF=4;Blocklify.JavaScript.Generator.ORDER_VOID=4;Blocklify.JavaScript.Generator.ORDER_DELETE=4;Blocklify.JavaScript.Generator.ORDER_MULTIPLICATION=5;Blocklify.JavaScript.Generator.ORDER_DIVISION=5;Blocklify.JavaScript.Generator.ORDER_MODULUS=5;Blocklify.JavaScript.Generator.ORDER_ADDITION=6;Blocklify.JavaScript.Generator.ORDER_SUBTRACTION=6;Blocklify.JavaScript.Generator.ORDER_BITWISE_SHIFT=7;Blocklify.JavaScript.Generator.ORDER_RELATIONAL=8;Blocklify.JavaScript.Generator.ORDER_IN=8;Blocklify.JavaScript.Generator.ORDER_INSTANCEOF=8;Blocklify.JavaScript.Generator.ORDER_EQUALITY=9;Blocklify.JavaScript.Generator.ORDER_BITWISE_AND=10;Blocklify.JavaScript.Generator.ORDER_BITWISE_XOR=11;Blocklify.JavaScript.Generator.ORDER_BITWISE_OR=12;Blocklify.JavaScript.Generator.ORDER_LOGICAL_AND=13;Blocklify.JavaScript.Generator.ORDER_LOGICAL_OR=14;Blocklify.JavaScript.Generator.ORDER_CONDITIONAL=15;Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT=16;Blocklify.JavaScript.Generator.ORDER_COMMA=17;Blocklify.JavaScript.Generator.ORDER_NONE=99;Blocklify.JavaScript.Generator.init=function(opt_workspace){return""};Blocklify.JavaScript.Generator.finish=function(code){return code};Blocklify.JavaScript.Generator.scrubNakedValue=function(line){return line+";\n"};Blocklify.JavaScript.Generator.quote_=function(string){string=string.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'");return"'"+string+"'"};Blocklify.JavaScript.Generator.scrub_=function(block,code){var commentCode="";if(!block.outputConnection||!block.outputConnection.targetConnection){var comment=block.getCommentText();if(comment){commentCode+=Blocklify.JavaScript.Generator.prefixLines(comment,"// ")+"\n"}for(var x=0;x<block.inputList.length;x++){if(block.inputList[x].type==Blockly.INPUT_VALUE){var childBlock=block.inputList[x].connection.targetBlock();if(childBlock){var comment=Blocklify.JavaScript.Generator.allNestedComments(childBlock);if(comment){commentCode+=Blocklify.JavaScript.Generator.prefixLines(comment,"// ")}}}}}var nextBlock=block.nextConnection&&block.nextConnection.targetBlock();var nextCode=Blocklify.JavaScript.Generator.blockToCode(nextBlock);return commentCode+code+nextCode};Blocklify.JavaScript.Generator.sequenceToCode=function(block,name){var targetBlock=block.getInputTargetBlock(name);if(targetBlock==null){return""}var nextBlock=targetBlock;var code="",blockCode,func=null,i=0;do{func=this[nextBlock.type];blockCode=(i!=0?" ,":"")+func.call(nextBlock,nextBlock);blockCode=blockCode.substring(0,blockCode.length-2);code+=blockCode;nextBlock=nextBlock.getNextBlock();i++}while(nextBlock!=null);return code};Blocklify.JavaScript.Generator.extrernalSources=[];Blocklify.JavaScript.Generator.blockToCode=function(block){if(!block){return""}if(block.disabled){return this.blockToCode(block.getNextBlock())}var func=this[block.type];if(!func){for(var i=0;i<Blocklify.JavaScript.Generator.extrernalSources.length;i++){func=Blocklify.JavaScript.Generator.extrernalSources[i][block.type];if(func){break}}if(!func){throw'Language "'+this.name_+'" does not know how to generate code '+'for block type "'+block.type+'".'}}var code=func.call(block,block);if(goog.isArray(code)){return[this.scrub_(block,code[0]),code[1]]}else if(goog.isString(code)){if(this.STATEMENT_PREFIX){code=this.STATEMENT_PREFIX.replace(/%1/g,"'"+block.id+"'")+code}return this.scrub_(block,code)}else if(code===null){return""}else{throw"Invalid code generated: "+code}};"use strict";goog.provide("Blocklify.JavaScript.importer");Blocklify.JavaScript.importer=new Blocklify.importer("JavaScript");Blocklify.JavaScript.importer.astParser=Blocklify.JavaScript.astParser;Blocklify.JavaScript.importer.no_inline_atomic_blocks=["FunctionExpression","ObjectExpression"];Blocklify.JavaScript.importer.convert=function(node,parent,level){switch(level){case"atomic":return Blocklify.JavaScript.importer.convert_atomic(node,parent,{});case"pattern":return Blocklify.JavaScript.importer.convert_pattern(node,parent,{patternEnabled:true});case"mixed":return Blocklify.JavaScript.importer.convert_pattern(node,parent,{patternEnabled:true,mixedEnabled:true})}};Blocklify.JavaScript.importer.notImplementedBlock=function(node){var block=goog.dom.createDom("block");block.setAttribute("type","js_notimplemented");Blocklify.JavaScript.importer.appendField(block,"TYPE",node.type);console.log("importer not yet implemented node:");console.log(node);return block};Blocklify.JavaScript.importer.createBlock=function(type){var block=goog.dom.createDom("block");block.setAttribute("type",type);return block};Blocklify.JavaScript.importer.appendField=function(block,name,value){var field=goog.dom.createDom("field",null,value);field.setAttribute("name",name);block.appendChild(field)};Blocklify.JavaScript.importer.appendValueInput=function(block,name,blockValue){var field=goog.dom.createDom("value",null,blockValue);field.setAttribute("name",name);block.appendChild(field)};Blocklify.JavaScript.importer.appendStatement=function(block,statements,parent,options){var tempBlock,lastBlock,statementBlock,rootBlock;if(statements.length==0){return}rootBlock=Blocklify.JavaScript.importer.convert_atomic(statements[0],parent,options);lastBlock=rootBlock;for(var i=1;i<statements.length;i++){tempBlock=goog.dom.createDom("next");statementBlock=Blocklify.JavaScript.importer.convert_atomic(statements[i],parent,options);if(typeof statementBlock=="object"){tempBlock.appendChild(statementBlock);lastBlock.appendChild(tempBlock);lastBlock=statementBlock}}if(block==null){return rootBlock}else{block.appendChild(rootBlock)}};Blocklify.JavaScript.importer.setOutput=function(block,bool){var mutation=block.getElementsByTagName("mutation")[0];if(mutation==undefined){mutation=goog.dom.createDom("mutation");block.appendChild(mutation)}mutation.setAttribute("output",bool+"")};Blocklify.JavaScript.importer.appendCloneMutation=function(block,name,elementName,elements,parent,options){var no_inline_blocks=Blocklify.JavaScript.importer.no_inline_atomic_blocks;var mutation=block.getElementsByTagName("mutation")[0];if(mutation==undefined){mutation=goog.dom.createDom("mutation");block.appendChild(mutation)}var inlineFlag=false;mutation.setAttribute(name,elements.length+"");for(var i=0;i<elements.length;i++){var elementBlock=Blocklify.JavaScript.importer.convert_atomic(elements[i],parent,options);Blocklify.JavaScript.importer.setOutput(elementBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,elementName+i,elementBlock);inlineFlag=inlineFlag||no_inline_blocks.indexOf(elements[i].type)!=-1}if(inlineFlag){block.setAttribute("inline","false")}};Blocklify.JavaScript.importer.convert_atomic=function(node,parent,options,patternNotImplemented){var block={},field;if(!options){options={}}if(options.patternEnabled&&options.patternEnabled==true&&(patternNotImplemented==undefined||patternNotImplemented==false)){block=Blocklify.JavaScript.importer.convert_pattern(node,parent,options);if(block!=null){return block}}var no_inline_blocks=Blocklify.JavaScript.importer.no_inline_atomic_blocks;if(node==null){block=goog.dom.createDom("block");block.setAttribute("type","js_null_value");return block}switch(node.type){case"Program":block=goog.dom.createDom("xml");Blocklify.JavaScript.importer.appendStatement(block,node.body,node,options);break;case"BlockStatement":block=Blocklify.JavaScript.importer.appendStatement(null,node.body,node,options);break;case"ExpressionStatement":block=Blocklify.JavaScript.importer.convert_atomic(node.expression,node,options);break;case"Literal":block=goog.dom.createDom("block");if(node.value==null){block.setAttribute("type","js_null_value")}else{var nodeType=typeof node.value;if(nodeType=="number"){block.setAttribute("type","js_literal_number");Blocklify.JavaScript.importer.appendField(block,"NUMBER",node.value+"")}else if(nodeType=="string"){block.setAttribute("type","js_literal_string");Blocklify.JavaScript.importer.appendField(block,"STRING",node.value)}else if(nodeType=="boolean"){block.setAttribute("type","js_literal_bool");Blocklify.JavaScript.importer.appendField(block,"BOOL",node.raw)}}break;case"AssignmentExpression":block=Blocklify.JavaScript.importer.createBlock("js_assignment_expression");var leftBlock=Blocklify.JavaScript.importer.convert_atomic(node.left,node,options);var rightBlock=Blocklify.JavaScript.importer.convert_atomic(node.right,node,options);if(no_inline_blocks.indexOf(node.right.type)!=-1){block.setAttribute("inline","false")}Blocklify.JavaScript.importer.setOutput(rightBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"VAR",leftBlock);Blocklify.JavaScript.importer.appendField(block,"OPERATOR",node.operator);Blocklify.JavaScript.importer.appendValueInput(block,"VALUE",rightBlock);break;case"VariableDeclarator":block=Blocklify.JavaScript.importer.createBlock("js_variable_declarator");var varBlock=Blocklify.JavaScript.importer.convert_atomic(node.id,node,options);if(node.init==null){node.init={type:"Identifier",name:"undefined"}}var initBlock=Blocklify.JavaScript.importer.convert_atomic(node.init,node,options);if(node.init){if(no_inline_blocks.indexOf(node.init.type)!=-1){block.setAttribute("inline","false")}}Blocklify.JavaScript.importer.setOutput(initBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"VAR",varBlock);Blocklify.JavaScript.importer.appendValueInput(block,"VALUE",initBlock);break;case"VariableDeclaration":if(node.declarations.length==1){block=Blocklify.JavaScript.importer.createBlock("js_variable_declaration_unary");if(node.declarations[0].init==null){node.declarations[0].init={type:"Identifier",name:"undefined"}}var initBlock=Blocklify.JavaScript.importer.convert_atomic(node.declarations[0].init,node.declarations[0],options);var varBlock=Blocklify.JavaScript.importer.convert_atomic(node.declarations[0].id,node.declarations[0],options);if(node.declarations[0].init){if(no_inline_blocks.indexOf(node.declarations[0].init.type)!=-1){block.setAttribute("inline","false")}}Blocklify.JavaScript.importer.setOutput(initBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"VAR",varBlock);Blocklify.JavaScript.importer.appendValueInput(block,"VALUE",initBlock)}else{var tempBlock,lastBlock,statementBlock,rootBlock;rootBlock=Blocklify.JavaScript.importer.convert_atomic(node.declarations[0],options);lastBlock=rootBlock;for(var i=1;i<node.declarations.length;i++){tempBlock=goog.dom.createDom("next");statementBlock=Blocklify.JavaScript.importer.convert_atomic(node.declarations[i],options);tempBlock.appendChild(statementBlock);lastBlock.appendChild(tempBlock);lastBlock=statementBlock}block=Blocklify.JavaScript.importer.createBlock("js_variable_declaration");Blocklify.JavaScript.importer.appendValueInput(block,"DECLARATIONS",rootBlock)}break;case"CallExpression":block=Blocklify.JavaScript.importer.createBlock("js_call_expression");var nameBlock=Blocklify.JavaScript.importer.convert_atomic(node.callee,node);Blocklify.JavaScript.importer.appendCloneMutation(block,"arguments","ARGUMENT",node.arguments,node,options);Blocklify.JavaScript.importer.appendValueInput(block,"NAME",nameBlock);break;case"FunctionExpression":if(node.id!=null){block=Blocklify.JavaScript.importer.createBlock("js_function_expression");var nameBlock=Blocklify.JavaScript.importer.convert_atomic(node.id,node,options)}else{block=Blocklify.JavaScript.importer.createBlock("js_anonimous_function_expression")}var stackBlock=Blocklify.JavaScript.importer.convert_atomic(node.body,node,options);Blocklify.JavaScript.importer.appendCloneMutation(block,"params","PARAM",node.params,node,options);if(node.id!=null){Blocklify.JavaScript.importer.appendValueInput(block,"NAME",nameBlock)}Blocklify.JavaScript.importer.appendValueInput(block,"STACK",stackBlock);break;case"FunctionDeclaration":block=Blocklify.JavaScript.importer.createBlock("js_function_expression");var nameBlock=Blocklify.JavaScript.importer.convert_atomic(node.id,node,options);var stackBlock=Blocklify.JavaScript.importer.convert_atomic(node.body,node,options);Blocklify.JavaScript.importer.setOutput(block,false);Blocklify.JavaScript.importer.appendCloneMutation(block,"params","PARAM",node.params,node,options);Blocklify.JavaScript.importer.appendValueInput(block,"NAME",nameBlock);Blocklify.JavaScript.importer.appendValueInput(block,"STACK",stackBlock);break;case"EmptyStatement":block="Ignore";break;case"Identifier":if(parent.type=="MemberExpression"&&parent.computed){block=Blocklify.JavaScript.importer.createBlock("js_computed_member_expression");var memberBlock=Blocklify.JavaScript.importer.convert_atomic(node,node);Blocklify.JavaScript.importer.appendValueInput(block,"MEMBER",memberBlock)}else if(node.name=="undefined"){block=Blocklify.JavaScript.importer.createBlock("js_undefined_value")}else{block=Blocklify.JavaScript.importer.createBlock("js_identifier");Blocklify.JavaScript.importer.appendField(block,"NAME",node.name)}break;case"MemberExpression":var current_node=node,count=2,memberBlock,member,parentM=node;while(current_node.object.type=="MemberExpression"){count++;current_node=current_node.object}block=Blocklify.JavaScript.importer.createBlock("js_member_expression");var mutation=goog.dom.createDom("mutation");block.appendChild(mutation);mutation.setAttribute("members",count+"");for(var i=count-1,current_node=node;i>=0;i--){member=i==0?current_node:current_node.property;memberBlock=Blocklify.JavaScript.importer.convert_atomic(member,parentM);Blocklify.JavaScript.importer.setOutput(memberBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"MEMBER"+i,memberBlock);current_node=current_node.object;parentM=current_node};break;case"ReturnStatement":block=Blocklify.JavaScript.importer.createBlock("js_return_statement");var argBlock=Blocklify.JavaScript.importer.convert_atomic(node.argument,node);Blocklify.JavaScript.importer.setOutput(argBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"VALUE",argBlock);break;case"UpdateExpression":if(node.prefix==true){block=Blocklify.JavaScript.importer.createBlock("js_update_expression_prefix")}else{block=Blocklify.JavaScript.importer.createBlock("js_update_expression_noprefix")}var argBlock=Blocklify.JavaScript.importer.convert_atomic(node.argument,node);Blocklify.JavaScript.importer.appendField(block,"OPERATOR",node.operator);Blocklify.JavaScript.importer.appendValueInput(block,"ARGUMENT",argBlock);break;case"BinaryExpression":block=Blocklify.JavaScript.importer.createBlock("js_binary_expression");var leftBlock=Blocklify.JavaScript.importer.convert_atomic(node.left,node);var rightBlock=Blocklify.JavaScript.importer.convert_atomic(node.right,node);Blocklify.JavaScript.importer.setOutput(rightBlock,true);Blocklify.JavaScript.importer.setOutput(leftBlock,true);Blocklify.JavaScript.importer.appendValueInput(block,"LEFT",leftBlock);Blocklify.JavaScript.importer.appendField(block,"OPERATOR",node.operator);Blocklify.JavaScript.importer.appendValueInput(block,"RIGHT",rightBlock);break;case"ObjectExpression":block=Blocklify.JavaScript.importer.createBlock("js_json_object");if(node.properties.length==0){return}for(var i=0;i<node.properties.length;i++){node.properties[i].type="ObjectElement"};var stackBlock=Blocklify.JavaScript.importer.appendStatement(null,node.properties,node,options);Blocklify.JavaScript.importer.appendValueInput(block,"ELEMENTS",stackBlock);break;case"ObjectElement":block=Blocklify.JavaScript.importer.createBlock("js_json_element");var key=Blocklify.JavaScript.importer.convert_atomic(node.key,node,options);var value=Blocklify.JavaScript.importer.convert_atomic(node.value,node,options);if(no_inline_blocks.indexOf(node.value.type)!=-1){block.setAttribute("inline","false")}Blocklify.JavaScript.importer.setOutput(value,true);Blocklify.JavaScript.importer.appendValueInput(block,"KEY",key);Blocklify.JavaScript.importer.appendValueInput(block,"VALUE",value);break;case"IfStatement":block=Blocklify.JavaScript.importer.createBlock("js_if_statement");var tests=[],consequents=[],current_node=node.alternate,countElseIf=0,countElse=0;tests.push(Blocklify.JavaScript.importer.convert_atomic(node.test,node,options));consequents.push(Blocklify.JavaScript.importer.convert_atomic(node.consequent,node,options));Blocklify.JavaScript.importer.setOutput(tests[0],true);while(current_node){if(current_node.type=="IfStatement"){countElseIf++;tests.push(Blocklify.JavaScript.importer.convert_atomic(current_node.test,current_node,options));Blocklify.JavaScript.importer.setOutput(tests[tests.length-1],true);consequents.push(Blocklify.JavaScript.importer.convert_atomic(current_node.consequent,current_node,options));current_node=current_node.alternate}else{countElse=1;var alternate=Blocklify.JavaScript.importer.convert_atomic(current_node.alternate||current_node,node,options);current_node=null}};var mutation=goog.dom.createDom("mutation");block.appendChild(mutation);mutation.setAttribute("elseif",countElseIf+"");mutation.setAttribute("else",countElse+"");Blocklify.JavaScript.importer.appendValueInput(block,"IF0",tests[0]);Blocklify.JavaScript.importer.appendValueInput(block,"DO0",consequents[0]);for(var i=1;i<=countElseIf;i++){Blocklify.JavaScript.importer.appendValueInput(block,"IF"+i,tests[i]);Blocklify.JavaScript.importer.appendValueInput(block,"DO"+i,consequents[i])}if(countElse==1){Blocklify.JavaScript.importer.appendValueInput(block,"ELSE",alternate)}break;case"ThisExpression":block=Blocklify.JavaScript.importer.createBlock("js_this_expression");break;case"ArrayExpression":block=Blocklify.JavaScript.importer.createBlock("js_array_expression");Blocklify.JavaScript.importer.appendCloneMutation(block,"elements","ELEMENT",node.elements,node,options);break;default:block=Blocklify.JavaScript.importer.notImplementedBlock(node)}return block};Blocklify.JavaScript.importer.importers=[];Blocklify.JavaScript.importer.convert_pattern=function(node,parent,options){var len=Blocklify.JavaScript.importer.importers.length,block=null;for(var i=0;i<len;i++){block=Blocklify.JavaScript.importer.importers[i](node,parent,options);if(block!==null){break}}if(block===null){if(options.mixedEnabled!=undefined&&options.mixedEnabled==true){block=Blocklify.JavaScript.importer.convert_atomic(node,parent,options,true)}else{block=Blocklify.JavaScript.importer.notImplementedBlock(node)}}return block};"use strict";goog.provide("Blocklify.JavaScript.Blocks");Blocklify.JavaScript.Blocks.setMutators=function(block,mutatorsList){for(var i=0;i<mutatorsList.length;i++){Blocklify.JavaScript.Blocks.mutators[mutatorsList[i].name](block,mutatorsList[i])}};"use strict";Blockly.Blocks["js_blocklify"]={init:function(){this.setColour(10);this.appendDummyInput().appendField(new Blockly.FieldTextArea(""),"CODE");this.setPreviousStatement(true);this.setNextStatement(true);Blocklify.JavaScript.Blocks.setMutators(this,[{name:"switch"}]);this.setTooltip("Blocklify.")}};"use strict";Blockly.Blocks["js_literal_number"]={init:function(){this.setColour(230);this.appendDummyInput().appendField(new Blockly.FieldTextInput("0",Blockly.FieldTextInput.numberValidator),"NUMBER");this.setOutput(true,"Number");this.setTooltip("Number.")}};Blockly.Blocks["js_null_value"]={init:function(){this.setColour(230);this.appendDummyInput().appendField("null");this.setOutput(true);this.setTooltip("Null value.")}};Blockly.Blocks["js_undefined_value"]={init:function(){this.setColour(230);this.appendDummyInput().appendField("undefined");this.setOutput(true);this.setTooltip("Undefined value.")}};Blockly.Blocks["js_literal_string"]={init:function(){this.setColour(160);this.appendDummyInput().appendField(this.newQuote_(true)).appendField(new Blockly.FieldTextInput(""),"STRING").appendField(this.newQuote_(false));this.setOutput(true,"String");this.setTooltip("String.")},newQuote_:function(open){if(open==this.RTL){var file="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAYAAACALL/6AAAA0UlEQVQY023QP0oDURSF8e8MImhlUIiCjWKhrUUK3YCIVkq6bMAF2LkCa8ENWLoNS1sLEQKprMQ/GBDks3kDM+Oc8nfPfTxuANQTYBeYAvdJLL4FnAFfwF2ST9Rz27kp5YH/kwrYp50LdaXHAU4rYNYzWAdeenx7AbgF5sAhcARsAkkyVQ+ACbAKjIGqta4+l78udXxc/LiJG+qvet0pV+q7+tHE+iJzdbGz8FhmOzVcqj/qq7rcKI7Ut1Leq70C1oCrJMMk343HB8ADMEzyVOMff72l48gwfqkAAAAASUVORK5CYII="}else{var file="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAYAAACALL/6AAAAvklEQVQY022PoapCQRRF97lBVDRYhBcEQcP1BwS/QLAqr7xitZn0HzRr8Rts+htmQdCqSbQIwmMZPMIw3lVmZu0zG44UAFSBLdBVBDAFZqFo8eYKtANfBC7AE5h8ZNOHd1FrDnh4VgmDO3ADkujDHPgHfkLZ84bfaLjg/hD6RFLq9z6wBDr+rvuZB1bAEDABY76pA2mGHyWSjvqmIemc4WsCLKOp4nssIj8wD8qS/iSVJK3N7OTeJPV9n72ZbV7iDuSc2BaQBQAAAABJRU5ErkJggg=="}return new Blockly.FieldImage(file,12,12,'"')}};Blockly.Blocks["js_literal_bool"]={init:function(){var BOOLEANS=[["true","true"],["false","false"]];this.setColour(220);this.setOutput(true,"Boolean");this.appendDummyInput().appendField(new Blockly.FieldDropdown(BOOLEANS),"BOOL");this.setTooltip(Blockly.Msg.LOGIC_BOOLEAN_TOOLTIP)}};Blockly.Blocks["js_this_expression"]={init:function(){this.setColour(120);this.appendDummyInput().appendField("this");this.setOutput(true);this.setTooltip("This expression.")}};Blockly.Blocks["js_json_object"]={init:function(){this.setColour(260);this.setOutput(true);this.appendDummyInput().appendField("object");this.appendStatementInput("ELEMENTS").setCheck("js_json_element");this.setTooltip("Object in JSON format.")}};Blockly.Blocks["js_json_element"]={init:function(){this.setColour(260);this.setPreviousStatement(true,"js_json_element");this.setNextStatement(true,"js_json_element");this.interpolateMsg(" %1 : %2",["KEY",null],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setInputsInline(true);this.setTooltip("Element of a object in JSON format.")}};Blockly.Blocks["js_identifier"]={init:function(){this.setColour(120);this.setOutput(true);this.appendDummyInput().appendField(new Blockly.FieldTextInput(""),"NAME");this.setTooltip("Identifier.")}};Blockly.Blocks["js_computed_member_expression"]={init:function(){this.setColour(160);this.interpolateMsg("[%1]",["MEMBER",null],Blockly.ALIGN_RIGHT);this.setOutput(true);this.setInputsInline(true);this.setTooltip("Computed member of member expression.")}};Blockly.Blocks["js_variable_declarator"]={init:function(){this.setColour(330);this.setPreviousStatement(true,"Declarator");this.setNextStatement(true,"Declarator");this.interpolateMsg("%1 = %2",["VAR",null],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setTooltip("Variable declarator.")}};Blockly.Blocks["js_variable_declaration_unary"]={init:function(){this.setColour(330);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.interpolateMsg("var %1 = %2",["VAR",null],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setTooltip("Variable declarator unary.")}};Blockly.Blocks["js_variable_declaration"]={init:function(){this.setColour(330);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.appendDummyInput().appendField("variable declaration");this.appendStatementInput("DECLARATIONS").setCheck("Declarator");this.setTooltip("Variable declaration.")}};"use strict";Blockly.Blocks["js_if_if_statement"]={init:function(){this.setColour(220);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_IF_TITLE_IF);this.appendStatementInput("STACK");this.setTooltip(Blockly.Msg.CONTROLS_IF_IF_TOOLTIP);this.contextMenu=false}};Blockly.Blocks["js_elseif_statement"]={init:function(){this.setColour(220);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF);this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSEIF_TOOLTIP);this.contextMenu=false}};Blockly.Blocks["js_else_statement"]={init:function(){this.setColour(220);this.appendDummyInput().appendField(Blockly.Msg.CONTROLS_IF_ELSE_TITLE_ELSE);this.setPreviousStatement(true);this.setTooltip(Blockly.Msg.CONTROLS_IF_ELSE_TOOLTIP);this.contextMenu=false}};Blockly.Blocks["js_assignment_expression"]={init:function(){var OPERATORS=[["=","="],["+=","+="],["-=","-="],["*=","*="],["/=","/="],["%=","%="],["&=","&="],["^=","^="],["|=","|="],[">>=",">>="],["<<=","<<="],[">>>=",">>>="]];this.setColour(330);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.interpolateMsg("set %1 %2 %3",["VAR",null],["OPERATOR",new Blockly.FieldDropdown(OPERATORS)],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setTooltip("Assignment expression.")}};Blockly.Blocks["js_update_expression_prefix"]={init:function(){var OPERATORS=[["++","++"],["--","--"]];this.setColour(230);this.setPreviousStatement(true);this.setNextStatement(true);this.interpolateMsg("%1 %2",["OPERATOR",new Blockly.FieldDropdown(OPERATORS)],["ARGUMENT",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setTooltip("Update expression with prefix.");Blocklify.JavaScript.Blocks.setMutators(this,[{name:"switch"}])}};Blockly.Blocks["js_update_expression_noprefix"]={init:function(){var OPERATORS=[["++","++"],["--","--"]];this.setColour(230);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.interpolateMsg("%1 %2",["ARGUMENT",null],["OPERATOR",new Blockly.FieldDropdown(OPERATORS)],Blockly.ALIGN_RIGHT);this.setTooltip("Update expression without prefix.");Blocklify.JavaScript.Blocks.setMutators(this,[{name:"switch"}])}};Blockly.Blocks["js_binary_expression"]={init:function(){var OPERATORS=[["+","+"],["-","-"],["*","*"],["/","/"],["%","%"],["==","=="],["!=","!="],[">",">"],["<","<"],[">=",">="],["<=","<="],["===","==="],["!==","!=="],["&","&"],["^","^"],["|","|"],[">>",">>"],["<<","<<"],[">>>",">>>"]];this.setColour(230);this.setOutput(true);this.interpolateMsg("%1 %2 %3",["LEFT",null],["OPERATOR",new Blockly.FieldDropdown(OPERATORS)],["RIGHT",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setTooltip("Binary expression.")}};Blockly.Blocks["js_member_expression"]={init:function(){this.setColour(240);this.setOutput(true);this.appendValueInput("MEMBER0");this.appendDummyInput("END");this.setInputsInline(true);this.setMutator(new Blockly.Mutator(["js_member_expression_member"]));this.memberCount=1;this.setTooltip("Member expression.");var argMutator={name:"clone",target:"MEMBER",mutatorContainer:"js_member_expression_container",mutatorArgument:"js_member_expression_member",elementCount:"memberCount"};Blocklify.JavaScript.Blocks.setMutators(this,[argMutator]);this.setMembers=this.setElements}};Blockly.Blocks["js_member_expression_container"]={init:function(){this.setColour(240);this.appendDummyInput().appendField("member expression");this.appendStatementInput("STACK");this.setTooltip("Add, remove or reorder members of the memeber expression.");this.contextMenu=false}};Blockly.Blocks["js_member_expression_member"]={init:function(){this.setColour(240);this.appendDummyInput().appendField("member");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add a member to a member expression.");this.contextMenu=false}};Blockly.Blocks["js_array_expression"]={init:function(){this.setColour(120);this.setOutput(true);this.appendValueInput("ELEMENT0").appendField("[");this.appendDummyInput("END").appendField("]");this.setInputsInline(true);this.setMutator(new Blockly.Mutator(["js_array_expression_element"]));this.elementCount=1;this.setTooltip("Array expression.");var argMutator={name:"clone",target:"ELEMENT",mutatorContainer:"js_array_expression_container",mutatorArgument:"js_array_expression_element",elementCount:"elementCount",startText:"[",endText:"]"};Blocklify.JavaScript.Blocks.setMutators(this,[argMutator])}};Blockly.Blocks["js_array_expression_container"]={init:function(){this.setColour(240);this.appendDummyInput().appendField("array");this.appendStatementInput("STACK");this.setTooltip("Add, remove or reorder elements of the array.");this.contextMenu=false}};Blockly.Blocks["js_array_expression_element"]={init:function(){this.setColour(240);this.appendDummyInput().appendField("element");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add a element to an array expression.");
this.contextMenu=false}};"use strict";goog.provide("Blocklify.JavaScript.Blocks.functions");goog.require("Blocklify.JavaScript.Blocks.mutators");Blockly.Blocks["js_function_expression"]={init:function(){this.setColour(290);this.appendDummyInput().appendField("function");this.appendValueInput("NAME");this.appendValueInput("PARAM0").appendField("(");this.appendDummyInput("END").appendField(")");this.appendStatementInput("STACK");this.setInputsInline(true);this.setMutator(new Blockly.Mutator(["js_function_expression_param"]));this.paramCount=1;this.setTooltip("Function expression.");var argMutator={name:"clone",target:"PARAM",mutatorContainer:"js_function_expression_container",mutatorArgument:"js_function_expression_param",elementCount:"paramCount",startText:"(",middleText:",",endText:")"};Blocklify.JavaScript.Blocks.setMutators(this,[argMutator,{name:"switch"}]);this.setParams=this.setElements;this.setOutput_(true);var removeStack=function(block){var stackBlock=this.getInputTargetBlock("STACK");var connection=null;if(stackBlock){connection=this.getInputTargetBlock("STACK").previousConnection}this.removeInput("STACK");return connection};var addStack=function(connection){var input=this.appendStatementInput("STACK");if(connection){connection.connect(input.connection)}};var blockDomToMutation=this.domToMutation;this.domToMutation=function(xmlElement){var connection=removeStack.call(this);blockDomToMutation.call(this,xmlElement);addStack.call(this,connection)};var blockSetParams=this.setParams;this.setParams=function(numparams){var connection=removeStack.call(this);blockSetParams.call(this,numparams);addStack.call(this,connection)};var blockCompose=this.compose;this.compose=function(containerBlock){var connection=removeStack.call(this);blockCompose.call(this,containerBlock);addStack.call(this,connection)}}};Blockly.Blocks["js_anonimous_function_expression"]={init:function(){this.setColour(290);this.appendDummyInput().appendField("function");this.appendValueInput("PARAM0").appendField("(");this.appendDummyInput("END").appendField(")");this.appendStatementInput("STACK");this.setInputsInline(true);this.setMutator(new Blockly.Mutator(["js_function_expression_param"]));this.paramCount=1;this.setTooltip("Function expression.");var argMutator={name:"clone",target:"PARAM",mutatorContainer:"js_function_expression_container",mutatorArgument:"js_function_expression_param",elementCount:"paramCount",startText:"(",middleText:",",endText:")"};Blocklify.JavaScript.Blocks.setMutators(this,[argMutator,{name:"switch"}]);this.setParams=this.setElements;this.setOutput_(true);var removeStack=function(block){var stackBlock=this.getInputTargetBlock("STACK");var connection=null;if(stackBlock){connection=this.getInputTargetBlock("STACK").previousConnection}this.removeInput("STACK");return connection};var addStack=function(connection){var input=this.appendStatementInput("STACK");if(connection){connection.connect(input.connection)}};var blockDomToMutation=this.domToMutation;this.domToMutation=function(xmlElement){var connection=removeStack.call(this);blockDomToMutation.call(this,xmlElement);addStack.call(this,connection)};var blockSetParams=this.setParams;this.setParams=function(numparams){var connection=removeStack.call(this);blockSetParams.call(this,numparams);addStack.call(this,connection)};var blockCompose=this.compose;this.compose=function(containerBlock){var connection=removeStack.call(this);blockCompose.call(this,containerBlock);addStack.call(this,connection)}}};Blockly.Blocks["js_function_expression_container"]={init:function(){this.setColour(290);this.appendDummyInput().appendField("function");this.appendStatementInput("STACK");this.setTooltip("Add, remove or reorder arguments of the function.");this.contextMenu=false}};Blockly.Blocks["js_function_expression_param"]={init:function(){this.setColour(290);this.appendDummyInput().appendField("pameter");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add an parameter to a function declaration.");this.contextMenu=false}};Blockly.Blocks["js_call_expression"]={init:function(){this.setColour(260);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.appendValueInput("NAME");this.appendValueInput("ARGUMENT0").appendField("(");this.appendDummyInput("END").appendField(")");this.setInputsInline(true);this.setMutator(new Blockly.Mutator(["js_call_expression_argument"]));this.argCount=1;this.setTooltip("Call expression.");var argMutator={name:"clone",target:"ARGUMENT",mutatorContainer:"js_call_expression_container",mutatorArgument:"js_call_expression_argument",elementCount:"argCount",startText:"(",middleText:",",endText:")"};Blocklify.JavaScript.Blocks.setMutators(this,[argMutator,{name:"switch"}]);this.setArguments=this.setElements;this.setOutput_(false)}};Blockly.Blocks["js_call_expression_container"]={init:function(){this.setColour(260);this.appendDummyInput().appendField("function");this.appendStatementInput("STACK");this.setTooltip("Add, remove or reorder arguments of the function.");this.contextMenu=false}};Blockly.Blocks["js_call_expression_argument"]={init:function(){this.setColour(260);this.appendDummyInput().appendField("argument");this.setPreviousStatement(true);this.setNextStatement(true);this.setTooltip("Add an argument to a function call.");this.contextMenu=false}};"use strict";goog.provide("Blocklify.JavaScript.Blocks.mutators");Blocklify.JavaScript.Blocks.mutators["clone"]=function(block,options){var xmlAttrName=options.target.toLowerCase()+"s";var elementCount=options.elementCount;if(!options.startText){options.startText=""}if(!options.middleText){options.middleText=""}if(!options.endText){options.endText=""}var blockMutationToDom=block.mutationToDom;block.mutationToDom=function(){if(blockMutationToDom){var container=blockMutationToDom.call(this)}else{var container=document.createElement("mutation")}container.setAttribute(xmlAttrName,this[elementCount]);return container};var blockDomToMutation=block.domToMutation;block.domToMutation=function(xmlElement){if(blockDomToMutation){blockDomToMutation.call(this,xmlElement)}if(this[elementCount]==0){this.removeInput("START")}for(var x=0;x<this[elementCount];x++){this.removeInput(options.target+x)}this.removeInput("END");this[elementCount]=parseInt(xmlElement.getAttribute(xmlAttrName),10);if(this[elementCount]==0){this.appendDummyInput("START").appendField(options.startText)}else{for(var x=0;x<this[elementCount];x++){var input=this.appendValueInput(options.target+x);if(x==0){input.appendField(options.startText)}else{input.appendField(options.middleText)}}}this.appendDummyInput("END").appendField(options.endText)};var blockDecompose=block.decompose;block.decompose=function(workspace){if(blockDecompose){blockDecompose.call(this,workspace)}var containerBlock=Blockly.Block.obtain(workspace,options.mutatorContainer);containerBlock.initSvg();var connection=containerBlock.getInput("STACK").connection;for(var x=0;x<this[elementCount];x++){var argBlock=Blockly.Block.obtain(workspace,options.mutatorArgument);argBlock.initSvg();connection.connect(argBlock.previousConnection);connection=argBlock.nextConnection}return containerBlock};var blockCompose=block.compose;block.compose=function(containerBlock){if(blockCompose){blockCompose.call(this,containerBlock)}if(this[elementCount]==0){this.removeInput("START")}for(var x=this[elementCount]-1;x>=0;x--){this.removeInput(options.target+x)}this.removeInput("END");this[elementCount]=0;var argBlock=containerBlock.getInputTargetBlock("STACK");while(argBlock){var input=this.appendValueInput(options.target+this[elementCount]);if(this[elementCount]==0){input.appendField(options.startText)}else{input.appendField(options.middleText)}if(argBlock.valueConnection_){input.connection.connect(argBlock.valueConnection_)}this[elementCount]++;argBlock=argBlock.nextConnection&&argBlock.nextConnection.targetBlock()}if(this[elementCount]==0){this.appendDummyInput("START").appendField(options.startText)}this.appendDummyInput("END").appendField(options.endText)};block.saveConnections=function(containerBlock){var argBlock=containerBlock.getInputTargetBlock("STACK");var x=0;while(argBlock){var input=this.getInput(options.target+x);argBlock.valueConnection_=input&&input.connection.targetConnection;x++;argBlock=argBlock.nextConnection&&argBlock.nextConnection.targetBlock()}};block.setElements=function(numels){if(this[elementCount]==0){this.removeInput("START")}for(var x=this[elementCount]-1;x>=0;x--){this.removeInput(options.target+x)}this.removeInput("END");this[elementCount]=numels;if(numels==0){this.appendDummyInput("START").appendField(options.startText)}else{for(var i=0;i<numels;i++){var input=this.appendValueInput(options.target+i);if(i==0){input.appendField(options.startText)}else{input.appendField(options.middleText)}}}this.appendDummyInput("END").appendField(options.endText)}};Blocklify.JavaScript.Blocks.mutators["switch"]=function(block,options){var elementCount=options.elementCount;var blockMutationToDom=block.mutationToDom;block.mutationToDom=function(){if(blockMutationToDom){var container=blockMutationToDom.call(this)}else{var container=document.createElement("mutation")}if(this.hasOutput_){container.setAttribute("output","true")}else{container.setAttribute("output","false")}return container};var blockDomToMutation=block.domToMutation;block.domToMutation=function(xmlElement){if(blockDomToMutation){blockDomToMutation.call(this,xmlElement)}this.setOutput_(xmlElement.getAttribute("output")=="true")};block.setOutput_=function(hasOutput){if(this.hasOutput_==hasOutput){return}this.unplug(true,false);if(hasOutput){this.setPreviousStatement(false);this.setNextStatement(false);this.setOutput(true)}else{this.setOutput(false);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement")}this.hasOutput_=hasOutput};var blockCustomContextMenu=block.customContextMenu;block.customContextMenu=function(options){if(blockCustomContextMenu){blockCustomContextMenu.call(this,options)}var option={enabled:true};if(this.hasOutput_){option.text="Remove Output"}else{option.text="Add Output"}var callbackFactory=function(block){return function(){block.setOutput_(!block.hasOutput_)}};option.callback=callbackFactory(this);options.push(option)}};"use strict";Blockly.Blocks["js_for_statement"]={init:function(){this.setColour(220);this.appendValueInput("CONDITION").setCheck("").appendField("for");this.appendStatementInput("FIRST").setCheck("").appendField("first");this.appendStatementInput("DO").setCheck("").appendField("do");this.appendStatementInput("STEP").setCheck("").appendField("step");this.setTooltip("");this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement")}};Blockly.Blocks["js_return_statement"]={init:function(){this.setColour(220);this.setPreviousStatement(true);this.setNextStatement(true);this.appendValueInput("VALUE").appendField("return");this.setTooltip("Function returns the value of input.")}};Blockly.Blocks["js_notimplemented"]={init:function(){this.setColour(0);this.setPreviousStatement(true);this.setNextStatement(true);this.appendDummyInput().appendField("Importer for").appendField(new Blockly.FieldTextInput(""),"TYPE").appendField("not yet implemented :(");this.setTooltip("Function returns the value of input.");Blocklify.JavaScript.Blocks.setMutators(this,[{name:"switch"}])}};Blockly.Blocks["js_if_statement"]={init:function(){this.setHelpUrl(Blockly.Msg.CONTROLS_IF_HELPURL);this.setColour(220);this.appendValueInput("IF0").setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_IF);this.appendStatementInput("DO0").appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);this.setPreviousStatement(true,"Statement");this.setNextStatement(true,"Statement");this.setMutator(new Blockly.Mutator(["js_elseif_statement","js_else_statement"]));var thisBlock=this;this.setTooltip(function(){if(!thisBlock.elseifCount_&&!thisBlock.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_1}else if(!thisBlock.elseifCount_&&thisBlock.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_2}else if(thisBlock.elseifCount_&&!thisBlock.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_3}else if(thisBlock.elseifCount_&&thisBlock.elseCount_){return Blockly.Msg.CONTROLS_IF_TOOLTIP_4}return""});this.elseifCount_=0;this.elseCount_=0},mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_){return null}var container=document.createElement("mutation");if(this.elseifCount_){container.setAttribute("elseif",this.elseifCount_)}if(this.elseCount_){container.setAttribute("else",1)}return container},domToMutation:function(xmlElement){this.elseifCount_=parseInt(xmlElement.getAttribute("elseif"),10);this.elseCount_=parseInt(xmlElement.getAttribute("else"),10);for(var i=1;i<=this.elseifCount_;i++){this.appendValueInput("IF"+i).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF);this.appendStatementInput("DO"+i).appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN)}if(this.elseCount_){this.appendStatementInput("ELSE").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)}},decompose:function(workspace){var containerBlock=Blockly.Block.obtain(workspace,"js_if_if_statement");containerBlock.initSvg();var connection=containerBlock.getInput("STACK").connection;for(var i=1;i<=this.elseifCount_;i++){var elseifBlock=Blockly.Block.obtain(workspace,"js_elseif_statement");elseifBlock.initSvg();connection.connect(elseifBlock.previousConnection);connection=elseifBlock.nextConnection}if(this.elseCount_){var elseBlock=Blockly.Block.obtain(workspace,"js_else_statement");elseBlock.initSvg();connection.connect(elseBlock.previousConnection)}return containerBlock},compose:function(containerBlock){if(this.elseCount_){this.removeInput("ELSE")}this.elseCount_=0;for(var i=this.elseifCount_;i>0;i--){this.removeInput("IF"+i);this.removeInput("DO"+i)}this.elseifCount_=0;var clauseBlock=containerBlock.getInputTargetBlock("STACK");while(clauseBlock){switch(clauseBlock.type){case"js_elseif_statement":this.elseifCount_++;var ifInput=this.appendValueInput("IF"+this.elseifCount_).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF);var doInput=this.appendStatementInput("DO"+this.elseifCount_);doInput.appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);if(clauseBlock.valueConnection_){ifInput.connection.connect(clauseBlock.valueConnection_)}if(clauseBlock.statementConnection_){doInput.connection.connect(clauseBlock.statementConnection_)}break;case"js_else_statement":this.elseCount_++;var elseInput=this.appendStatementInput("ELSE");elseInput.appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE);if(clauseBlock.statementConnection_){elseInput.connection.connect(clauseBlock.statementConnection_)}break;default:throw"Unknown block type."}clauseBlock=clauseBlock.nextConnection&&clauseBlock.nextConnection.targetBlock()}},setCounts:function(elseifCount_,elseCount_){if(this.elseCount_){this.removeInput("ELSE")}this.elseCount_=0;for(var i=this.elseifCount_;i>0;i--){this.removeInput("IF"+i);this.removeInput("DO"+i)}this.elseifCount_=0;while(this.elseifCount_<elseifCount_){this.elseifCount_++;var ifInput=this.appendValueInput("IF"+this.elseifCount_).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF);var doInput=this.appendStatementInput("DO"+this.elseifCount_);doInput.appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN)}while(this.elseCount_<elseCount_){this.elseCount_++;var elseInput=this.appendStatementInput("ELSE");elseInput.appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)}},saveConnections:function(containerBlock){var clauseBlock=containerBlock.getInputTargetBlock("STACK");var i=1;while(clauseBlock){switch(clauseBlock.type){case"js_elseif_statement":var inputIf=this.getInput("IF"+i);var inputDo=this.getInput("DO"+i);clauseBlock.valueConnection_=inputIf&&inputIf.connection.targetConnection;clauseBlock.statementConnection_=inputDo&&inputDo.connection.targetConnection;i++;break;case"js_else_statement":var inputDo=this.getInput("ELSE");clauseBlock.statementConnection_=inputDo&&inputDo.connection.targetConnection;break;default:throw"Unknown block type."}clauseBlock=clauseBlock.nextConnection&&clauseBlock.nextConnection.targetBlock()}}};Blocklify.JavaScript.Generator["js_literal_number"]=function(block){var code=parseFloat(block.getFieldValue("NUMBER"));return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_literal_string"]=function(block){var code=Blocklify.JavaScript.Generator.quote_(block.getFieldValue("STRING"));return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_literal_bool"]=function(block){var code=block.getFieldValue("BOOL");return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_null_value"]=function(block){return["null",Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_undefined_value"]=function(block){return["undefined",Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_json_object"]=function(block){var elements=Blocklify.JavaScript.Generator.statementToCode(block,"ELEMENTS");var code=" {"+(elements!=""?"\n":"")+elements+"}";return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blocklify.JavaScript.Generator["js_json_element"]=function(block,context){var key=Blocklify.JavaScript.Generator.valueToCode(block,"KEY",Blocklify.JavaScript.Generator.ORDER_ATOMIC);var value=Blocklify.JavaScript.Generator.valueToCode(block,"VALUE",Blocklify.JavaScript.Generator.ORDER_ATOMIC);var code=key+": "+value+",\n";return code};Blocklify.JavaScript.Generator["js_identifier"]=function(block){var name=block.getFieldValue("NAME");var code=name;return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]};Blockly.Blocks["identifier_member_expression"]={init:function(){this.setColour(330);this.setOutput(true);this.interpolateMsg("%1.%2",["NAME",new Blockly.FieldTextInput("")],["NEXT",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT);this.setInputsInline(false);this.setTooltip("Identifier of member expression.")}};Blocklify.JavaScript.Generator["js_variable_declarator"]=function(block){var variable=Blocklify.JavaScript.Generator.valueToCode(block,"VAR",Blocklify.JavaScript.Generator.ORDER_ATOMIC);var value=Blocklify.JavaScript.Generator.valueToCode(block,"VALUE",Blocklify.JavaScript.Generator.ORDER_ATOMIC);if(value=="undefined"){return" "+variable+","}else{return" "+variable+" = "+value+","}};Blocklify.JavaScript.Generator["js_variable_declaration_unary"]=function(block){var variable=Blocklify.JavaScript.Generator.valueToCode(block,"VAR",Blocklify.JavaScript.Generator.ORDER_ATOMIC);var value=Blocklify.JavaScript.Generator.valueToCode(block,"VALUE",Blocklify.JavaScript.Generator.ORDER_ATOMIC);if(value=="undefined"){return"var "+variable+";\n"}else{return"var "+variable+" = "+value+";\n"}};Blocklify.JavaScript.Generator["js_variable_declaration"]=function(block){var declarations=Blocklify.JavaScript.Generator.statementToCode(block,"DECLARATIONS");declarations=declarations.substring(2,declarations.length-1);return"var"+declarations+";\n"};Blocklify.JavaScript.Generator["js_assignment_expression"]=function(block){var variable=Blocklify.JavaScript.Generator.valueToCode(block,"VAR",Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT);var operator=block.getFieldValue("OPERATOR");var value=Blocklify.JavaScript.Generator.valueToCode(block,"VALUE",Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT);var code=variable+" "+operator+" "+value;if(block.outputConnection){return[code,Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_update_expression_prefix"]=function(block){var argument=Blocklify.JavaScript.Generator.valueToCode(block,"ARGUMENT",Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT);var operator=block.getFieldValue("OPERATOR");var OPERATORS={"++":Blocklify.JavaScript.Generator.ORDER_INCREMENT,"--":Blocklify.JavaScript.Generator.ORDER_DECREMENT};var code=operator+argument;if(block.outputConnection){return[code,OPERATORS[operator]]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_update_expression_noprefix"]=function(block){var argument=Blocklify.JavaScript.Generator.valueToCode(block,"ARGUMENT",Blocklify.JavaScript.Generator.ORDER_ASSIGNMENT);var operator=block.getFieldValue("OPERATOR");var OPERATORS={"++":Blocklify.JavaScript.Generator.ORDER_INCREMENT,"--":Blocklify.JavaScript.Generator.ORDER_DECREMENT};var code=argument+operator;if(block.outputConnection){return[code,OPERATORS[operator]]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_binary_expression"]=function(block){var OPERATORS={"+":Blocklify.JavaScript.Generator.ORDER_ADDITION,"-":Blocklify.JavaScript.Generator.ORDER_SUBTRACTION,"*":Blocklify.JavaScript.Generator.ORDER_MULTIPLICATION,"/":Blocklify.JavaScript.Generator.ORDER_DIVISION,"%":Blocklify.JavaScript.Generator.ORDER_MODULUS,"==":Blocklify.JavaScript.Generator.ORDER_EQUALITY,"!=":Blocklify.JavaScript.Generator.ORDER_EQUALITY,">":Blocklify.JavaScript.Generator.ORDER_RELATIONAL,"<":Blocklify.JavaScript.Generator.ORDER_RELATIONAL,">=":Blocklify.JavaScript.Generator.ORDER_RELATIONAL,"<=":Blocklify.JavaScript.Generator.ORDER_RELATIONAL,"===":Blocklify.JavaScript.Generator.ORDER_EQUALITY,"&":Blocklify.JavaScript.Generator.ORDER_BITWISE_AND,"^":Blocklify.JavaScript.Generator.ORDER_BITWISE_XOR,"|":Blocklify.JavaScript.Generator.ORDER_BITWISE_OR,">>":Blocklify.JavaScript.Generator.ORDER_BITWISE_SHIFT,"<<":Blocklify.JavaScript.Generator.ORDER_BITWISE_SHIFT,">>>":Blocklify.JavaScript.Generator.ORDER_BITWISE_SHIFT};var operator=block.getFieldValue("OPERATOR");var left=Blocklify.JavaScript.Generator.valueToCode(block,"LEFT",OPERATORS[operator]);var right=Blocklify.JavaScript.Generator.valueToCode(block,"RIGHT",OPERATORS[operator]);var code=left+" "+operator+" "+right;if(block.outputConnection){return[code,OPERATORS[operator]]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_member_expression"]=function(block){var members=[];for(var i=0;i<block.memberCount;i++){members[i]=Blocklify.JavaScript.Generator.valueToCode(block,"MEMBER"+i,Blocklify.JavaScript.Generator.ORDER_ATOMIC)}var code=members.join(".");return[code,Blocklify.JavaScript.Generator.ORDER_MEMBER];if(block.outputConnection){return[code,OPERATORS[operator]]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_function_expression"]=function(block){var branch=Blocklify.JavaScript.Generator.statementToCode(block,"STACK");var name=Blocklify.JavaScript.Generator.valueToCode(block,"NAME",Blocklify.JavaScript.Generator.ORDER_ATOMIC);var args=[];for(var i=0;i<block.paramCount;i++){args[i]=Blocklify.JavaScript.Generator.valueToCode(block,"PARAM"+i,Blocklify.JavaScript.Generator.ORDER_ATOMIC)}var code="function "+name+"("+args.join(", ")+") {\n"+branch+"}";if(block.outputConnection){return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_anonimous_function_expression"]=function(block){var branch=Blocklify.JavaScript.Generator.statementToCode(block,"STACK");var args=[];for(var i=0;i<block.paramCount;i++){args[i]=Blocklify.JavaScript.Generator.valueToCode(block,"PARAM"+i,Blocklify.JavaScript.Generator.ORDER_ATOMIC)}var code="function ("+args.join(", ")+") {\n"+branch+"}";return[code,Blocklify.JavaScript.Generator.ORDER_TYPEOF]};Blocklify.JavaScript.Generator["js_call_expression"]=function(block){var name=Blocklify.JavaScript.Generator.valueToCode(block,"NAME",Blocklify.JavaScript.Generator.ORDER_FUNCTION_CALL);var args=[];for(var i=0;i<block.argCount;i++){args[i]=Blocklify.JavaScript.Generator.valueToCode(block,"ARGUMENT"+i,Blocklify.JavaScript.Generator.ORDER_ATOMIC)}var code=name+"("+args.join(", ")+")";if(block.outputConnection){return[code,Blocklify.JavaScript.Generator.ORDER_ATOMIC]}else{return code+";\n"}};Blocklify.JavaScript.Generator["js_for_statement"]=function(block){var value_condition=Blocklify.JavaScript.Generator.valueToCode(block,"CONDITION",Blocklify.JavaScript.Generator.ORDER_NONE);var statements_first="",func;var first_targetblock=block.getInputTargetBlock("FIRST");if(first_targetblock){if(first_targetblock.type=="js_variable_declaration"||first_targetblock.type=="js_variable_declaration_unary"){func=Blocklify.JavaScript.Generator[first_targetblock.type];statements_first=func.call(first_targetblock,first_targetblock);statements_first=Blocklify.JavaScript.Generator.statementToCode(block,"FIRST");statements_first=statements_first.substring(2,statements_first.length-2)}else{statements_first=Blocklify.JavaScript.Generator.sequenceToCode(block,"FIRST")}}var statements_do=Blocklify.JavaScript.Generator.statementToCode(block,"DO");var statements_step=Blocklify.JavaScript.Generator.sequenceToCode(block,"STEP");var code="for ("+statements_first+"; "+value_condition+"; "+statements_step+") {\n"+statements_do+"}";return code};Blocklify.JavaScript.Generator["js_return_statement"]=function(block){var code="return "+Blocklify.JavaScript.Generator.valueToCode(block,"VALUE",Blocklify.JavaScript.Generator.ORDER_NONE)+";";return code+"\n"};Blocklify.JavaScript.Generator["js_if_statement"]=function(block){var n=0;var argument=Blocklify.JavaScript.Generator.valueToCode(block,"IF"+n,Blocklify.JavaScript.Generator.ORDER_NONE)||"false";var branch=Blocklify.JavaScript.Generator.statementToCode(block,"DO"+n);var code="if ("+argument+") {\n"+branch+"}";for(n=1;n<=block.elseifCount_;n++){argument=Blocklify.JavaScript.Generator.valueToCode(block,"IF"+n,Blocklify.JavaScript.Generator.ORDER_NONE)||"false";branch=Blocklify.JavaScript.Generator.statementToCode(block,"DO"+n);code+=" else if ("+argument+") {\n"+branch+"}"}if(block.elseCount_){branch=Blocklify.JavaScript.Generator.statementToCode(block,"ELSE");code+=" else {\n"+branch+"}"}return code+"\n"};